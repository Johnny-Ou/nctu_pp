import numpy as np
import matplotlib.pyplot as plt

size = np.array([8,
                16,
                32,
                64,
                128,
                256,
                512,
                1024,
                2048,
                4096,
                8192,
                16384,
                32768,
                65536,
                131072,
                262144,
                524288,
                1048576,
                2097152,
                4194304,
                8388608,
                16777216,
                33554432,
                67108864,
                134217728,
                268435456,
                536870912,
                1073741824])

interTime = np.array([0.000054153,
                0.000053708,
                0.000053344,
                0.000053278,
                0.000053232,
                0.000052971,
                0.000052814,
                0.000061072,
                0.000092712,
                0.000092436,
                0.000175671,
                0.000208175,
                0.000386402,
                0.000752371,
                0.001323966,
                0.002407165,
                0.004681785,
                0.009175223,
                0.018159393,
                0.036404749,
                0.072546747,
                0.148729033,
                0.310325835,
                0.596236190,
                1.150127147,
                2.299425607,
                4.601273477,
                9.198642811])

intraTime = np.array([0.000000619,
                0.000000403,
                0.000000418,
                0.000000417,
                0.000000490,
                0.000000518,
                0.000000802,
                0.000000867,
                0.000001010,
                0.000003256,
                0.000004106,
                0.000005368,
                0.000007179,
                0.000010916,
                0.000018272,
                0.000032966,
                0.000061747,
                0.000097352,
                0.000151622,
                0.000471184,
                0.001280597,
                0.002614684,
                0.005185761,
                0.010333124,
                0.020549279,
                0.040628088,
                0.080020417,
                0.158505519])

m1, b1 = np.polyfit(size, interTime, 1)
m2, b2 = np.polyfit(size, intraTime, 1)
latency1 = b1 / (10**-6)
latency2 = b2 / (10**-6)
bandwidth1 = 1 / m1 / (10**9)
bandwidth2 = 1 / m2 / (10**9)
# plt.plot(size, interTime, 'o')
plt.plot(size, intraTime, 'o')
# plt.plot(size, m1*size + b1, label='Inter node')
plt.plot(size, m2*size + b2, label='intra node')
plt.title("Ping-Pong Plot")
plt.xlabel("Size(B)")
plt.ylabel("Ping-pong time(sec)")
plt.legend(loc='upper right', shadow=True)
plt.show()
print(latency1)
print(bandwidth1)
print(latency2)
print(bandwidth2)